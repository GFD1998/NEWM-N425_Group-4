{"ast":null,"code":"var _jsxFileName = \"C:\\\\XAMPP\\\\htdocs\\\\projects\\\\NEWM-N425_Group-4\\\\mcdonald-client\\\\src\\\\services\\\\useAuth.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useState, createContext, useContext } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { settings } from \"../config/config\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(null);\nconst AuthProvider = _ref => {\n  _s();\n  var _location$state, _location$state$from;\n  let {\n    children\n  } = _ref;\n  const [isAuthed, setIsAuthed] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [user, setUser] = useState();\n  let location = useLocation();\n  let navigate = useNavigate();\n  let from = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : (_location$state$from = _location$state.from) === null || _location$state$from === void 0 ? void 0 : _location$state$from.pathname) || \"/signin\";\n\n  // User Login\n  const login = account => {\n    const url = settings.baseApiUrl + \"/users/authJWT\";\n    fetch(url, {\n      method: \"POST\",\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(account)\n    }).then(response => {\n      if (!response.ok) {\n        throw response;\n      }\n      return response.json();\n    }).then(result => {\n      setError(null);\n      setIsLoading(false);\n      setIsAuthed(true);\n      setUser({\n        name: result.name,\n        role: result.role,\n        jwt: result.jwt\n      });\n      navigate(from, {\n        replace: true\n      });\n    }).catch(err => {\n      setIsLoading(false);\n      console.log(err);\n      if (err.status == 401) {\n        setError(\"Incorrect username/password. Please try again.\");\n      } else {\n        setError(\"An error has occurred. Please try again.\");\n      }\n    });\n  };\n\n  // User Logout\n  const logout = () => {\n    setIsAuthed(false);\n    setUser(null);\n  };\n\n  // User Signup\n  const signup = account => {\n    const url = settings.baseApiUrl + \"/users\";\n    console.log(url);\n    fetch(url, {\n      method: \"POST\",\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(account)\n    }).then(response => {\n      if (!response.ok) {\n        throw response;\n      }\n      return response.json();\n    }).then(result => {\n      setError(null);\n      setIsLoading(false);\n      //setIsAuthed(true);\n      setUser({\n        name: result.data.name,\n        role: result.data.role\n      });\n    }).catch(err => {\n      setIsLoading(false);\n      setError(\"An error has occurred. Please try again.\");\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      error,\n      isLoading,\n      isAuthed,\n      user,\n      login,\n      logout,\n      signup\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthProvider, \"zkviBwfD7VxZJwmBKjrvYLhKCh4=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = AuthProvider;\nconst useAuth = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport { AuthProvider, useAuth };\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["useState","createContext","useContext","useLocation","useNavigate","settings","jsxDEV","_jsxDEV","AuthContext","AuthProvider","_ref","_s","_location$state","_location$state$from","children","isAuthed","setIsAuthed","isLoading","setIsLoading","error","setError","user","setUser","location","navigate","from","state","pathname","login","account","url","baseApiUrl","fetch","method","headers","body","JSON","stringify","then","response","ok","json","result","name","role","jwt","replace","catch","err","console","log","status","logout","signup","data","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","$RefreshReg$"],"sources":["C:/XAMPP/htdocs/projects/NEWM-N425_Group-4/mcdonald-client/src/services/useAuth.js"],"sourcesContent":["import {useState, createContext, useContext} from \"react\";\r\nimport {useLocation, useNavigate} from \"react-router-dom\";\r\nimport {settings} from \"../config/config\";\r\n\r\nconst AuthContext = createContext(null);\r\nconst AuthProvider = ({children}) => {\r\n    const [isAuthed, setIsAuthed] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState(null);\r\n    const [user, setUser] = useState();\r\n    let location = useLocation();\r\n    let navigate = useNavigate();\r\n    let from = location.state?.from?.pathname || \"/signin\";\r\n\r\n    // User Login\r\n    const login = (account) => {\r\n        const url = settings.baseApiUrl + \"/users/authJWT\";\r\n        fetch(url, {\r\n            method: \"POST\",\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(account)\r\n        })\r\n            .then(response => {\r\n                if (!response.ok) {\r\n                    throw (response);\r\n                }\r\n                return response.json();\r\n            })\r\n            .then(\r\n                (result) => {\r\n                    setError(null);\r\n                    setIsLoading(false);\r\n                    setIsAuthed(true);\r\n                    setUser({name: result.name, role: result.role, jwt: result.jwt});\r\n                    navigate(from, {replace: true});\r\n                })\r\n            .catch(err => {\r\n                setIsLoading(false);\r\n                console.log(err);\r\n                if (err.status == 401) {\r\n                    setError(\"Incorrect username/password. Please try again.\");\r\n                } else {\r\n                    setError(\"An error has occurred. Please try again.\");\r\n                }\r\n            })\r\n    };\r\n\r\n    // User Logout\r\n    const logout = () => {\r\n        setIsAuthed(false);\r\n        setUser(null);\r\n    };\r\n\r\n\r\n    // User Signup\r\n    const signup = (account) => {\r\n        const url = settings.baseApiUrl + \"/users\";\r\n        console.log(url);\r\n        fetch(url, {\r\n            method: \"POST\",\r\n            headers: {\r\n                'Accept': 'application/json',\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(account)\r\n        })\r\n            .then(response => {\r\n                if (!response.ok) {\r\n                    throw (response);\r\n                }\r\n                return response.json();\r\n            })\r\n            .then(\r\n                (result) => {\r\n                    setError(null);\r\n                    setIsLoading(false);\r\n                    //setIsAuthed(true);\r\n                    setUser({name: result.data.name, role: result.data.role});\r\n                })\r\n            .catch(err => {\r\n                setIsLoading(false);\r\n                setError(\"An error has occurred. Please try again.\");\r\n            });\r\n    }\r\n    return (\r\n        <AuthContext.Provider value = {{error, isLoading, isAuthed, user, login, logout, signup}}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    )};\r\nconst useAuth = () => useContext(AuthContext);\r\nexport {AuthProvider, useAuth};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}